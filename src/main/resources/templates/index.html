<!DOCTYPE HTML>

<html xmlns:th="http://www.thymeleaf.org">
<head th:replace="includes/dependencies :: dependencies">
  <title>Startseite</title>
</head>
<body>

<div th:replace="includes/navigationbar :: navigationbar"></div>

<div class="container">

  <h1>Startseite</h1>

  <p>Willkommen bei der Verwaltung aller Veranstaltungen und AGs unserer Schule.</p>
  <p>Wir sind sicher, es ist auch für Dich etwas interessantes dabei.</p>
  <br>

  <h2>Verfügbare Veranstaltungen und Arbeitsgemeinschaften</h2>

  <table class="table">
    <thead>
    <th>Name</th>
    <th>Beschreibung</th>
    <th>Treffpunkt</th>
    <th>Startdatum</th>
    <th>Enddatum</th>
    <th>Auswählen</th>
    </thead>
    <tbody>
    <tr th:each="oneEvent : ${allActiveEvents}">
      <td><a th:href="@{/event/{id}(id=${oneEvent.id})}"><b th:text="${oneEvent.title}"></b></a></td>
      <td><span th:utext="${oneEvent.summary}"></span></td>
      <td><span th:utext="${oneEvent.location}"></span></td>
      <td><span th:utext="${oneEvent.startDate}"></span></td>
      <td><span th:utext="${oneEvent.endDate}"></span></td>
      <td>
        <div th:if="${assignments.get(oneEvent.id)}">
          ✔️ angemeldet
        </div>

        <div th:if="!${assignments.get(oneEvent.id)}">
             <div class="popup btn btn-primary" th:onclick="|openPopup(${oneEvent.id})|">anmelden
               <span class="popuptext" th:id="${oneEvent.id}">
                 Sicher, dass du dich anmelden möchtest ?
              <form th:action="@{/event/{id}/assign(id=${oneEvent.id})}" th:method="post">
                   <button class="btn btn-primary">
                     anmelden
                   </button>
                </form>
               </span>
             </div>
             </div>



      </td>
    </tr>
    </tbody>
  </table>

  <h2>Entwürfe</h2>

  <table class="table">
    <thead>
    <th>Name</th>
    <th>Beschreibung</th>
    <th>Treffpunkt</th>
    <th>Startdatum</th>
    <th>Enddatum</th>
    <th>Auswählen</th>
    </thead>
    <tbody>
    <tr th:each="oneActivity : ${allInactiveEvents}">
      <td><a th:href="@{/event/{id}(id=${oneActivity.id})}"><b th:text="${oneActivity.title}"></b></a></td>
      <td><span th:utext="${oneActivity.summary}"></span></td>
      <td><span th:utext="${oneActivity.location}"></span></td>
      <td><span th:utext="${oneActivity.startDate}"></span></td>
      <td><span th:utext="${oneActivity.endDate}"></span></td>
      <td>
        <div th:if="${assignments.get(oneActivity.id)}">
          ✔️ angemeldet
        </div>
        <div th:if="!${assignments.get(oneActivity.id)}">
          <form th:action="@{/event/{id}/assign(id=${oneActivity.id})}" th:method="post">
            <button class="btn btn-primary">anmelden</button>
          </form>
        </div>
      </td>
    </tr>
    </tbody>
  </table>


  <a th:href="@{/event/create}"> Neue AG anlegen</a>
</div>

<div th:replace="includes/footer :: footer"></div>
<div th:replace="includes/dependenciesfooter :: dependenciesfooter"></div>

<script>
  function openPopup(id) {
  var popup = document.getElementById(id);
  popup.classList.toggle("show");
  }
</script>

<style>

  .popup {
  position: relative;
  display: inline-block;
  cursor: pointer;
  -webkit-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
  user-select: none;
}

/* The actual popup */
.popup .popuptext {
  visibility: hidden;
  width: 160px;
  background-color: #555;
  color: #fff;
  text-align: center;
  border-radius: 6px;
  padding: 8px 0;
  position: absolute;
  z-index: 1;
  bottom: 125%;
  left: 50%;
  margin-left: -80px;
}

/* Popup arrow */
.popup .popuptext::after {
  content: "";
  position: absolute;
  top: 100%;
  left: 50%;
  margin-left: -5px;
  border-width: 5px;
  border-style: solid;
  border-color: #555 transparent transparent transparent;
}

/* Toggle this class - hide and show the popup */
.popup .show {
  visibility: visible;
  -webkit-animation: fadeIn 1s;
  animation: fadeIn 1s;
}

/* Add animation (fade in the popup) */
@-webkit-keyframes fadeIn {
  from {opacity: 0;}
  to {opacity: 1;}
}

@keyframes fadeIn {
  from {opacity: 0;}
  to {opacity:1 ;}
}
</style>


</body>
</html>
